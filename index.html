<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PairFlow: Closed-Form Source-Target Coupling for Few-Step Generation in Discrete Flow Models</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script>
        MathJax = {
            tex: {
                inlineMath: [['$', '$'], ['\\(', '\\)']]
            }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>

<body>
    <header>
        <div class="container">
            <h1>PairFlow: Closed-Form Source-Target Coupling for Few-Step Generation in Discrete Flow Models</h1>
            <div class="authors">
                <p>Mingue Park*, Jisung Hwang*, Seungwoo Yoo*, Kyeongmin Yeo, Minhyuk Sung</p>
                <p class="affiliation">KAIST</p>
            </div>
            <div class="links">
                <a href="https://arxiv.org/abs/2512.20063" class="btn" target="_blank">Paper</a>
                <a href="#" class="btn">Code (Coming Soon)</a>
            </div>
        </div>
    </header>


    <!-- <section id="tldr">
        <div class="container">
            <div class="tldr-box">
                <div class="tldr-title">TL;DR</div>
                <p>
                    <strong>PairFlow</strong> is a teacher-free acceleration framework for Discrete Flow Models that
                    builds source–target training pairs via a closed-form inversion/backward velocity, so the model
                    learns straighter, few-step paths. It’s cheap <span class="highlight-red">(≈0.2–1.7% of full
                        training compute)</span> yet improves
                    few-step sampling and can even strengthen the base model for later distillation.
                </p>
            </div>
        </div>
    </section> -->

    <section id="teaser">
        <div class="container">
            <h1>TL;DR</h1>
            <p>
                <strong>PairFlow</strong> is a teacher-free acceleration framework for Discrete Flow Models that
                builds source–target training pairs via a closed-form inversion/backward velocity, so the model
                learns straighter, few-step paths. It’s cheap <span class="highlight-red">(≈0.2–1.7% of full
                    training compute)</span> yet improves
                few-step sampling and can even strengthen the base model for later distillation.
            </p>
        </div>
        <div class="container" style="text-align: center; margin-top: 40px; margin-bottom: 20px;">
            <img src="assets/images/pairflow-teaser.png" alt="PairFlow Teaser"
                style="max-width: 100%; height: auto; border-radius: 8px;">
        </div>
    </section>
    <div class="container">
        <h1>Abstract</h1>
        <p>
            We introduce PairFlow, a lightweight preprocessing step for training Discrete Flow Models (DFMs) to
            achieve few-step sampling without requiring a pretrained teacher. DFMs have recently emerged as a new
            class of generative models for discrete data, offering strong performance. However, they suffer from
            slow sampling due to their iterative nature. Existing acceleration methods largely depend on finetuning,
            which introduces substantial additional training overhead. PairFlow addresses this issue with a
            lightweight preprocessing step. Inspired by ReFlow and its extension to DFMs, we train DFMs from coupled
            samples of source and target distributions, without requiring any pretrained teacher.
        </p>
        <p>
            At the core of our approach is a closed-form inversion for DFMs, which allows efficient construction of
            paired source–target samples. Despite its extremely low cost, taking only up to 1.7% of the compute
            needed for full model training, PairFlow matches or even surpasses the performance of two-stage training
            involving finetuning. Furthermore, models trained with our framework provide stronger base models for
            subsequent distillation, yielding further acceleration after finetuning. Experiments on molecular data
            as well as binary and RGB images demonstrate the broad applicability and effectiveness of our approach.
        </p>
    </div>
    </section>

    <section id="method">
        <div class="container">
            <h1>Method</h1>
            <p>
                PairFlow is a training framework for DFMs that enables few-step sampling by constructing paired
                source–target samples using closed-form velocities. While inspired by ReDi-style coupling-driven
                training, our approach eliminates the need for a pretrained teacher by using closed-form formulations
                and achieves acceleration without finetuning. The algorithm for computing source–target pairs is fully
                parallelizable and requires at most 1.7% of compute needed for full model training.
            </p>

            <div class="method-layout">
                <div class="method-figure">
                    <img src="assets/images/pairflow.png" alt="PairFlow Method Overview">
                    <p class="caption">Figure 1: Illustrations of data inversion in PairFlow and the standard corruption
                        process in UDLM. PairFlow achieves a lower average Hamming distance (6.47 vs. 9.0), promoting
                        straighter paths during training.</p>
                </div>
                <div class="method-algorithm">
                    <div style="text-align: center; margin: 20px 0;">
                        <img src="assets/images/pairflow_algorithm1.png"
                            alt="Algorithm 1: PairFlow Source-Target Coupling"
                            style="max-width: 90%; height: auto; border: 1px solid #e1e4e8; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.08);">
                    </div>
                </div>
            </div>

            <h2>Closed-Form Velocity Fields</h2>
            <p>
                We derive the closed-form forward velocity field $\hat{v}_t(x^i, z)$ for discrete domains.
                For the empirical target distribution $\tilde{q}(x)$, the closed-form denoiser $p_{1|t}(x^i|z)$ and its
                associated velocity field $\hat{v}_t(x^i, z)$ are given by:
            </p>
            <p class="math-block">
                $$
                \begin{align}
                p_{1|t}(x^i|z) = \cfrac{\sum_{m=1}^M \delta_{d_{m}^i}(x^i) \gamma^{- h(d_{m}, z)}}{ \sum_{m=1}^M
                \gamma^{- h(d_{m}, z)}} \quad \Longrightarrow \quad
                \hat{v}_t(x^i, z) = \frac{\dot\kappa_t}{1 - \kappa_t} \left[p_{1|t}(x^i|z) - \delta_{z}(x^i) \right]
                \tag{9}
                \end{align}
                $$
            </p>
            <p>
                To effectively identify suitable source-target pairs, we derive the closed-form backward velocity.
                Specifically, we first derive the closed-form noise predictor $p_{0|t}(x^i|z)$:
            </p>
            <p class="math-block">
                $$
                \begin{align}
                p_{0|t}(x^i|z) = \delta_{z}(x^i) - \frac{\kappa_t(K \delta_{x^i}(z^i) - 1)}{1 + (K-1)\kappa_t}
                \frac{\sum_{m=1}^M \delta_{d_m^i}(z^i)\gamma^{-h(d_m, z)}}{\sum_{m=1}^M \gamma^{-h(d_m, z)}} \tag{11}
                \end{align}
                $$
            </p>
            <p>
                Substituting this into the definition of the backward velocity field, we obtain the desired closed-form
                expression:
            </p>
            <p class="math-block">
                $$
                \begin{align}
                \check{v}_t(x^i, z) = \frac{\dot{\kappa}_t(K \delta_{x^i}(z^i)-1)}{1 + (K-1)\kappa_t} \frac{\sum_{m=1}^M
                \delta_{d_m^i}(z^i)\gamma^{-h(d_m, z)}}{\sum_{m=1}^M \gamma^{-h(d_m, z)}} \tag{12}
                \end{align}
                $$
            </p>
        </div>
    </section>

    <section id="results">
        <div class="container">
            <h1>Quantitative Results</h1>
            <p>
                We validate the effectiveness of the proposed method and the source–target pairs it discovers across
                several discrete generative modeling benchmarks involving molecular data and images.
            </p>

            <!-- <h3>Quantitative Results</h3> -->
            <div class="results-grid triple-grid">
                <div class="result-item">
                    <!-- <h4>QM9 Validity</h4> -->
                    <img src="assets/images/01_qm9_valid_base.png" alt="QM9 Validity">
                </div>
                <div class="result-item">
                    <!-- <h4>QM9 Uniqueness</h4> -->
                    <img src="assets/images/01_qm9_unique_base.png" alt="QM9 Uniqueness">
                </div>
                <div class="result-item">
                    <!-- <h4>QM9 Novelty</h4> -->
                    <img src="assets/images/01_qm9_novel_base.png" alt="QM9 Novelty">
                </div>
            </div>
            <p class="caption">Figure 2: Step-wise performance analysis on the QM9 dataset.</p>

            <div class="results-grid triple-grid">
                <div class="result-item">
                    <!-- <h4>ZINC-250k Validity</h4> -->
                    <img src="assets/images/02_zinc_valid_base.png" alt="ZINC-250k Validity">
                </div>
                <div class="result-item">
                    <!-- <h4>ZINC-250k Uniqueness</h4> -->
                    <img src="assets/images/02_zinc_unique_base.png" alt="ZINC-250k Uniqueness">
                </div>
                <div class="result-item">
                    <!-- <h4>ZINC-250k Novelty</h4> -->
                    <img src="assets/images/02_zinc_novel_base.png" alt="ZINC-250k Novelty">
                </div>
            </div>
            <p class="caption">Figure 3: Step-wise performance analysis on the ZINC-250k dataset.</p>

            <!-- <h3>Image Generation</h3> -->
            <div class="results-grid triple-grid">
                <div class="result-item">
                    <!-- <h4>MNIST-Binary FID</h4> -->
                    <img src="assets/images/03_binary_mnist_fid_base.png" alt="MNIST-Binary FID">
                </div>
                <div class="result-item">
                    <!-- <h4>CIFAR-10 FID</h4> -->
                    <img src="assets/images/04_cifar_fid_base.png" alt="CIFAR-10 FID">
                </div>
                <div class="result-item">
                    <!-- <h4>CIFAR-10 IS</h4> -->
                    <img src="assets/images/04_cifar_is_base.png" alt="CIFAR-10 IS">
                </div>
            </div>
            <p class="caption">Figure 4: Step-wise performance analysis on discretized image datasets.</p>

            <h1>Qualitative Results</h1>
            <div class="visual-results-container">

                <!-- 1. MNIST Application (Top) -->
                <div class="mnist-section">
                    <div class="mnist-section-title">MNIST-Binary (1-Step)</div>
                    <div class="mnist-grid">
                        <!-- Header Row (7 Columns) -->
                        <div class="mnist-col-header">MDLM</div>
                        <div class="mnist-col-header">UDLM</div>
                        <div class="mnist-col-header"><span class="pairflow-badge blue">PAIRFLOW</span></div>
                        <div class="mnist-col-header">UDLM + DCD</div>
                        <div class="mnist-col-header"><span class="pairflow-badge blue">PAIRFLOW</span> + DCD</div>
                        <div class="mnist-col-header">UDLM + ReDi</div>
                        <div class="mnist-col-header"><span class="pairflow-badge blue">PAIRFLOW</span> + ReDi</div>

                        <!-- Row Index 0 -->
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_MDLM_0.png" alt="MDLM 0"></div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_UDLM_0.png" alt="UDLM 0"></div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_ours_0.png" alt="Ours 0"></div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_UDLM_DCD_0.png" alt="UDLM+DCD 0">
                        </div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_ours_DCD_0.png" alt="Ours+DCD 0">
                        </div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_UDLM_ReDi_0.png" alt="UDLM+ReDi 0">
                        </div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_ours_ReDi_0.png" alt="Ours+ReDi 0">
                        </div>

                        <!-- Row Index 1 -->
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_MDLM_1.png" alt="MDLM 1"></div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_UDLM_1.png" alt="UDLM 1"></div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_ours_1.png" alt="Ours 1"></div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_UDLM_DCD_1.png" alt="UDLM+DCD 1">
                        </div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_ours_DCD_1.png" alt="Ours+DCD 1">
                        </div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_UDLM_ReDi_1.png" alt="UDLM+ReDi 1">
                        </div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_ours_ReDi_1.png" alt="Ours+ReDi 1">
                        </div>

                        <!-- Row Index 2 -->
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_MDLM_2.png" alt="MDLM 2"></div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_UDLM_2.png" alt="UDLM 2"></div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_ours_2.png" alt="Ours 2"></div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_UDLM_DCD_2.png" alt="UDLM+DCD 2">
                        </div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_ours_DCD_2.png" alt="Ours+DCD 2">
                        </div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_UDLM_ReDi_2.png" alt="UDLM+ReDi 2">
                        </div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_ours_ReDi_2.png" alt="Ours+ReDi 2">
                        </div>

                        <!-- Row Index 3 -->
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_MDLM_3.png" alt="MDLM 3"></div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_UDLM_3.png" alt="UDLM 3"></div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_ours_3.png" alt="Ours 3"></div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_UDLM_DCD_3.png" alt="UDLM+DCD 3">
                        </div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_ours_DCD_3.png" alt="Ours+DCD 3">
                        </div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_UDLM_ReDi_3.png" alt="UDLM+ReDi 3">
                        </div>
                        <div class="mnist-img-cell"><img src="assets/images/MNIST_ours_ReDi_3.png" alt="Ours+ReDi 3">
                        </div>
                    </div>
                </div>

                <!-- 2. CIFAR Application (Bottom, Side-by-Side) -->
                <div class="cifar-wrapper">
                    <!-- 64 Steps -->
                    <div class="cifar-block">
                        <div class="cifar-block-title">CIFAR-10 (64 Steps)</div>
                        <!-- MDLM -->
                        <div class="cifar-row">
                            <div class="cifar-label-cell">MDLM</div>
                            <div class="cifar-images-cell">
                                <img src="assets/images/CIFAR64_MDLM_0.png" alt="MDLM 0">
                                <img src="assets/images/CIFAR64_MDLM_1.png" alt="MDLM 1">
                                <img src="assets/images/CIFAR64_MDLM_2.png" alt="MDLM 2">
                                <img src="assets/images/CIFAR64_MDLM_3.png" alt="MDLM 3">
                                <img src="assets/images/CIFAR64_MDLM_4.png" alt="MDLM 4">
                            </div>
                        </div>
                        <!-- UDLM -->
                        <div class="cifar-row">
                            <div class="cifar-label-cell">UDLM</div>
                            <div class="cifar-images-cell">
                                <img src="assets/images/CIFAR64_UDLM_0.png" alt="UDLM 0">
                                <img src="assets/images/CIFAR64_UDLM_1.png" alt="UDLM 1">
                                <img src="assets/images/CIFAR64_UDLM_2.png" alt="UDLM 2">
                                <img src="assets/images/CIFAR64_UDLM_3.png" alt="UDLM 3">
                                <img src="assets/images/CIFAR64_UDLM_4.png" alt="UDLM 4">
                            </div>
                        </div>
                        <!-- PAIRFLOW -->
                        <div class="cifar-row">
                            <div class="cifar-label-cell"><span class="pairflow-badge blue">PAIRFLOW</span></div>
                            <div class="cifar-images-cell is-pairflow">
                                <img src="assets/images/CIFAR64_ours_0.png" alt="Ours 0">
                                <img src="assets/images/CIFAR64_ours_1.png" alt="Ours 1">
                                <img src="assets/images/CIFAR64_ours_2.png" alt="Ours 2">
                                <img src="assets/images/CIFAR64_ours_3.png" alt="Ours 3">
                                <img src="assets/images/CIFAR64_ours_4.png" alt="Ours 4">
                            </div>
                        </div>
                    </div>

                    <!-- 256 Steps -->
                    <div class="cifar-block">
                        <div class="cifar-block-title">CIFAR-10 (256 Steps)</div>
                        <!-- MDLM -->
                        <div class="cifar-row">
                            <div class="cifar-label-cell">MDLM</div>
                            <div class="cifar-images-cell">
                                <img src="assets/images/CIFAR256_MDLM_0.png" alt="MDLM 0">
                                <img src="assets/images/CIFAR256_MDLM_1.png" alt="MDLM 1">
                                <img src="assets/images/CIFAR256_MDLM_2.png" alt="MDLM 2">
                                <img src="assets/images/CIFAR256_MDLM_3.png" alt="MDLM 3">
                                <img src="assets/images/CIFAR256_MDLM_4.png" alt="MDLM 4">
                            </div>
                        </div>
                        <!-- UDLM -->
                        <div class="cifar-row">
                            <div class="cifar-label-cell">UDLM</div>
                            <div class="cifar-images-cell">
                                <img src="assets/images/CIFAR256_UDLM_0.png" alt="UDLM 0">
                                <img src="assets/images/CIFAR256_UDLM_1.png" alt="UDLM 1">
                                <img src="assets/images/CIFAR256_UDLM_2.png" alt="UDLM 2">
                                <img src="assets/images/CIFAR256_UDLM_3.png" alt="UDLM 3">
                                <img src="assets/images/CIFAR256_UDLM_4.png" alt="UDLM 4">
                            </div>
                        </div>
                        <!-- PAIRFLOW -->
                        <div class="cifar-row">
                            <div class="cifar-label-cell"><span class="pairflow-badge blue">PAIRFLOW</span></div>
                            <div class="cifar-images-cell is-pairflow">
                                <img src="assets/images/CIFAR256_ours_0.png" alt="Ours 0">
                                <img src="assets/images/CIFAR256_ours_1.png" alt="Ours 1">
                                <img src="assets/images/CIFAR256_ours_2.png" alt="Ours 2">
                                <img src="assets/images/CIFAR256_ours_3.png" alt="Ours 3">
                                <img src="assets/images/CIFAR256_ours_4.png" alt="Ours 4">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section id="citation">
        <div class="container">
            <h2>Citation</h2>
            <pre><code>@article{park2025pairflow,
  title={PairFlow: Closed-Form Source-Target Coupling for Few-Step Generation in Discrete Flow Models},
  author={Park, Mingue and Hwang, Jisung and Yoo, Seungwoo and Yeo, Kyeongmin and Sung, Minhyuk},
  journal={arXiv preprint arXiv:2512.20063},
  year={2025}
}
</code></pre>
        </div>
    </section>
    <!-- 
    <footer>
        <div class="container">
            <p>&copy; 2025 KAIST. All rights reserved.</p>
        </div>
    </footer> -->
</body>

</html>